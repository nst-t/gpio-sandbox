(this["webpackJsonpgpio-sandbox"]=this["webpackJsonpgpio-sandbox"]||[]).push([[0],{424:function(e,t,n){"use strict";n.r(t);var i,c,a=n(0),r=n(48),o=n.n(r),l=n(488),s=n(12),d=n(500),j=n(219),u=n(5),O=n(38),b=n(4),p=n(243),h=n(496),x=n(497),m=n(504),f=n(505),g=n(507),y=n(501),v=n(506),w=n(508),I=n(498),D=n(502),S=n(503),k=n(487),U=n(495),C=n(490),R=n(489),P=n(494),E=n(509),G=n(510),N=n(476),z=n(478),W=n(1),H=function(e){var t=e.openViews,n=e.updateViews,i=function(e){return function(){return n(e,!t[e])}};return Object(W.jsxs)("div",{children:[Object(W.jsxs)(P.a,{button:!0,onClick:i("pins"),children:[Object(W.jsx)(E.a,{children:Object(W.jsx)(N.a,{color:t.pins?"primary":"disabled"})}),Object(W.jsx)(G.a,{primary:"Dashboard"})]}),Object(W.jsxs)(P.a,{button:!0,onClick:i("data"),children:[Object(W.jsx)(E.a,{children:Object(W.jsx)(z.a,{color:t.data?"primary":"disabled"})}),Object(W.jsx)(G.a,{primary:"View Data"})]})]})},L=n(511),M=n(515),A=n(514),V=n(512),B=n(513),K=function(e){var t=e.children;return Object(W.jsx)(y.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0,children:t})},T=function(e){var t=e.data;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(K,{children:"GPIO Pin Data"}),Object(W.jsxs)(L.a,{size:"small",children:[Object(W.jsx)(V.a,{children:Object(W.jsxs)(B.a,{children:[Object(W.jsx)(A.a,{width:100,children:"Pin Id"}),Object(W.jsx)(A.a,{width:100,children:"Time"}),Object(W.jsx)(A.a,{align:"right",children:"Value"})]})}),Object(W.jsx)(M.a,{children:t.sort((function(e,t){return t.date-e.date})).slice(0,25).map((function(e,t){var n=e.id,i=e.date,c=e.value;return Object(W.jsxs)(B.a,{children:[Object(W.jsx)(A.a,{children:n}),Object(W.jsx)(A.a,{children:i}),Object(W.jsx)(A.a,{align:"right",children:c?"1":"0"})]},"pin-".concat(n,":").concat(i,":").concat(t))}))})]})]})},F=n(516),J=n(517),X=n(499),Y=n(518),q=n(484);!function(e){e.IN="in",e.OUT="out"}(i||(i={})),function(e){e.IO="io",e.POWER="power",e.GROUND="ground"}(c||(c={}));var Q=n(49),Z=n(479),$=n(480),_=n(238),ee=n(50),te=n(239),ne=n(245),ie=function(e){var t=e.data,n=Object(Q.a)(),i=[];return t&&(i=t.filter((function(e){return e.date>Date.now()-6e4})).map((function(e){return Object(O.a)(Object(O.a)({},e),{},{value:null===e.value?null:Number(e.value)})}))),Object(W.jsx)(d.a,{width:"100%",height:"100%",sx:{backgroundColor:"primary"},children:Object(W.jsx)(Z.a,{children:Object(W.jsxs)($.a,{data:i,margin:{top:0,right:0,bottom:0,left:0},children:[Object(W.jsx)(_.a,{hide:!0,dataKey:"date",type:"number",domain:[Date.now()-6e4,Date.now()],stroke:n.palette.text.secondary,style:n.typography.body2,children:Object(W.jsx)(ee.a,{position:"bottom",style:Object(O.a)({textAnchor:"middle",fill:n.palette.text.primary},n.typography.body1),children:"Time"})}),Object(W.jsx)(te.a,{hide:!0,type:"number",domain:[0,1],stroke:n.palette.text.secondary,style:n.typography.body2}),Object(W.jsx)(ne.a,{isAnimationActive:!1,type:"stepAfter",dataKey:"value",stroke:n.palette.primary.main,dot:!1,connectNulls:!1,strokeLinejoin:"miter"})]})})})},ce=new Map([[1,{name:"pow3v3",direction:null,type:c.GROUND}],[2,{name:"pow5v",direction:null,type:c.POWER}],[3,{name:"gpio 2",direction:null,type:c.IO}],[4,{name:"pow5v",direction:null,type:c.POWER}],[5,{name:"gpio 3",direction:null,type:c.IO}],[6,{name:"gnd",direction:null,type:c.GROUND}],[7,{name:"gpio 4",direction:null,type:c.IO}],[8,{name:"gpio uart",direction:null,type:c.IO}],[9,{name:"gnd",direction:null,type:c.GROUND}],[10,{name:"gpio uart",direction:null,type:c.IO}],[11,{name:"gpio 17",direction:null,type:c.IO}],[12,{name:"gpio pcm",direction:null,type:c.IO}],[13,{name:"gpio 27",direction:null,type:c.IO}],[14,{name:"gnd",direction:null,type:c.GROUND}],[15,{name:"gpio 22",direction:null,type:c.IO}],[16,{name:"gpio",direction:null,type:c.IO}],[17,{name:"pow3v3",direction:null,type:c.POWER}],[18,{name:"gpio",direction:null,type:c.IO}],[19,{name:"gpio 10",direction:null,type:c.IO}],[20,{name:"gnd",direction:null,type:c.IO}],[21,{name:"gpio 9",direction:null,type:c.IO}],[22,{name:"gpio",direction:null,type:c.IO}],[23,{name:"gpio 11",direction:null,type:c.IO}],[24,{name:"gpio spi",direction:null,type:c.IO}],[25,{name:"gnd",direction:null,type:c.GROUND}],[26,{name:"gpio spi",direction:null,type:c.IO}],[27,{name:"gpio 0",direction:null,type:c.IO}],[28,{name:"gpio i2c",direction:null,type:c.IO}],[29,{name:"gpio 5",direction:null,type:c.IO}],[30,{name:"gnd",direction:null,type:c.GROUND}],[31,{name:"gpio 6",direction:null,type:c.IO}],[32,{name:"gpio",direction:null,type:c.IO}],[33,{name:"gpio 13",direction:null,type:c.IO}],[34,{name:"gnd",direction:null,type:c.GROUND}],[35,{name:"gpio 19",direction:null,type:c.IO}],[36,{name:"gpio",direction:null,type:c.IO}],[37,{name:"gpio 26",direction:null,type:c.IO}],[38,{name:"gpio pcm",direction:null,type:c.IO}],[39,{name:"gnd",direction:null,type:c.GROUND}],[40,{name:"gpio pcm",direction:null,type:c.IO}]]),ae=function(e){var t=e.onClick,n=e.type;return Object(W.jsx)(F.a,{onClick:t,children:Object(W.jsx)(q.a,{color:n===c.IO?"primary":n===c.POWER?"secondary":"disabled"})})},re=function(e){var t=e.activePins,n=e.sendHandler,c=e.connected,r=e.setError,o=Object(a.useState)(ce),l=Object(s.a)(o,2),d=l[0],j=l[1],u=Object(a.useContext)(Oe),b=Object(a.useMemo)((function(){return function(e){var t=e.id,i=e.value,c=ce.get(t);c&&"io"===c.type&&(ce.set(t,Object(O.a)(Object(O.a)({},c),{},{value:i})),j(new Map(ce)),n({id:t,value:i,action:"write"}))}}),[n]),p=Object(a.useMemo)((function(){return function(e){var t=e.id,i=e.newDirection,c=ce.get(t);if(c&&"io"===c.type){var a=i||c.direction;ce.set(t,Object(O.a)(Object(O.a)({},c),{},{direction:a})),j(new Map(ce)),n({action:"set",direction:a,id:t})}}}),[n]);return Object(a.useEffect)((function(){var e=0;Array.from(d.entries()).forEach((function(t){var n=Object(s.a)(t,2),i=n[0],c=n[1];c.data=u.filter((function(e){var t=e.id;return i===t})),c.data.length>e&&(e=c.data.length)}))}),[u,d]),Object(W.jsx)(J.a,{component:D.a,sx:{flexGrow:1},children:Object(W.jsxs)(L.a,{"aria-label":"GPIO Pinout",children:[Object(W.jsxs)("colgroup",{children:[Object(W.jsx)("col",{style:{width:"auto"}}),Object(W.jsx)("col",{style:{width:"auto"}}),Object(W.jsx)("col",{style:{width:"auto"}}),Object(W.jsx)("col",{style:{width:"24px"}}),Object(W.jsx)("col",{style:{width:"80%"}})]}),Object(W.jsx)(M.a,{children:Array.from(d.entries()).filter(t.length>0?function(e){var n=Object(s.a)(e,1)[0];return t.includes(n)}:function(e){return e}).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return Object(W.jsxs)(B.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(W.jsx)(A.a,{sx:{minWidth:"100px",backgroundColor:"default",cursor:"pointer"},children:Object(W.jsxs)(y.a,{paragraph:!1,fontSize:10,children:["[",n,"]",a.name]})}),Object(W.jsx)(A.a,{align:"left",children:"io"===a.type&&Object(W.jsxs)(X.a,{size:"small",color:"primary",value:a.direction,exclusive:!0,sx:{fontSize:6,height:"10px",lineHeight:"10px"},onChange:function(e,t){c?p({id:n,newDirection:t}):r({wsHost:!0})},children:[Object(W.jsx)(Y.a,{sx:{fontSize:8},value:"in",children:"In"}),Object(W.jsx)(Y.a,{sx:{fontSize:8},value:"out",children:"Out"})]})}),Object(W.jsx)(A.a,{align:"left",children:"io"===a.type&&Object(W.jsxs)(X.a,{size:"small",color:"out"===a.direction?"primary":"secondary",value:a.value,exclusive:!0,sx:{fontSize:6,height:"10px",lineHeight:"10px"},disabled:a.direction!==i.OUT,onChange:function(e,t){if(c){var i=null===t?a.value:t;void 0!==i&&b({id:n,value:i})}},children:[Object(W.jsx)(Y.a,{sx:{fontSize:8},value:1,children:"1"}),Object(W.jsx)(Y.a,{sx:{fontSize:8},value:0,children:"0"})]})}),Object(W.jsx)(A.a,{align:"left",children:Object(W.jsx)(ae,{type:a.type})}),Object(W.jsx)(A.a,{align:"right",children:Object(W.jsx)(D.a,{sx:{p:2,display:"flex",flexDirection:"column",height:"80px",minWidth:"240px"},children:Object(W.jsx)(ie,{data:a.data||[]})})})]},n)}))})]})})},oe=function(e){return Object(W.jsxs)(y.a,Object(O.a)(Object(O.a)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Copyright \xa9 ",Object(W.jsx)(S.a,{color:"inherit",href:"https://nstrumenta.com/",children:"nstrumenta"})," ",(new Date).getFullYear(),"."]}))},le=Object(b.a)(m.a,{})((function(e){return{zIndex:e.theme.zIndex.drawer+1,marginLeft:72,width:"calc(100% - ".concat(72,"px)")}})),se=Object(b.a)(x.a,{})((function(e){var t=e.theme;return{"& .MuiDrawer-paper":Object(u.a)({position:"relative",whiteSpace:"nowrap",width:72,boxSizing:"border-box",overflowX:"hidden"},t.breakpoints.up("sm"),{width:t.spacing(9)})}})),de={dark:Object(p.a)({palette:{mode:"dark"}}),light:Object(p.a)({palette:{mode:"light"}})},je=function(e){var t=e.wsUrl,n=e.setWsUrl,i=e.connected,c=e.sendHandler,r=Object(a.useState)([]),o=Object(s.a)(r,2),j=o[0],b=o[1],p=Object(a.useState)(""),x=Object(s.a)(p,2),m=x[0],S=x[1],P=Object(a.useState)(t),E=Object(s.a)(P,2),G=E[0],N=E[1],z=Object(a.useState)({pins:!0,data:!0}),L=Object(s.a)(z,2),M=L[0],A=L[1],V=Object(a.useState)("light"),B=Object(s.a)(V,2),K=B[0],F=B[1],J=Object(a.useState)({}),X=Object(s.a)(J,2),Y=X[0],q=X[1],Q=Object(k.a)("(prefers-color-scheme: dark)");Object(a.useEffect)((function(){F(Q?"dark":"light")}),[Q]),Object(a.useEffect)((function(){void 0!==Y.wsHost&&q(Object(O.a)(Object(O.a)({},Y),{},{wsHost:!i}))}),[i,Y]),Object(a.useEffect)((function(){N(t)}),[t]);var Z=Object(a.useContext)(Oe),$=Object(a.useMemo)((function(){return function(e){n(e);var t=new URLSearchParams(window.location.search);t.set("wsUrl",e);var i=new URL("".concat(window.location.origin,"?").concat(decodeURIComponent(t.toString())));window.history.pushState("","",i),console.log("updated wsUrl to ".concat(e))}}),[n]),_=Object(a.useMemo)((function(){return function(e){var t=e.replace(/\s/g,"").split(",").map(Number).filter((function(e){return e>0&&e<=40}));console.log({pins:t}),b(t)}}),[]);return Object(a.useEffect)((function(){S(j.join(","))}),[j]),Object(W.jsx)(h.a,{theme:de[K],children:Object(W.jsxs)(d.a,{sx:{display:"flex"},children:[Object(W.jsx)(l.a,{}),Object(W.jsx)(le,{position:"absolute",children:Object(W.jsxs)(f.a,{children:[Object(W.jsx)(y.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,sx:{flexGrow:1},children:"Raspberry PI GPIO"}),Object(W.jsx)(y.a,{children:"Theme"}),Object(W.jsx)(U.a,{value:K,onChange:function(){return F((function(e){return"light"===e?"dark":"light"}))}})]})}),Object(W.jsxs)(se,{variant:"permanent",children:[Object(W.jsx)(f.a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",px:[1]},children:Object(W.jsx)(R.a,{color:i?"secondary":"disabled",sx:{backgroundColor:"action"}})}),Object(W.jsx)(v.a,{}),Object(W.jsx)(g.a,{children:Object(W.jsx)(H,{updateViews:function(e,t){A(Object(O.a)(Object(O.a)({},M),{},Object(u.a)({},e,t)))},openViews:M})})]}),Object(W.jsxs)(d.a,{component:"main",sx:{flexGrow:1,height:"100vh",overflow:"auto"},children:[Object(W.jsx)(f.a,{}),Object(W.jsxs)(w.a,{maxWidth:!1,sx:{mt:4,mb:4},children:[Object(W.jsxs)(I.a,{container:!0,spacing:3,children:[Object(W.jsx)(I.a,{item:!0,xs:6,children:Object(W.jsx)(D.a,{sx:{padding:2},children:Object(W.jsx)(C.a,{variant:"standard",label:"websocket host",onChange:function(e){return N(e.target.value)},onBlur:function(){return $(G)},value:G,onKeyDown:function(e){"enter"===e.key.toLowerCase()&&$(G)},error:Boolean(Y.wsHost),fullWidth:!0})})}),Object(W.jsx)(I.a,{item:!0,xs:6,children:Object(W.jsx)(D.a,{sx:{padding:2},children:Object(W.jsx)(C.a,{variant:"standard",label:"pin filter (comma separated list)",onChange:function(e){return S(e.target.value)},onBlur:function(){return _(m)},value:m,onKeyDown:function(e){"enter"===e.key.toLowerCase()&&_(m)},fullWidth:!0})})}),M.pins&&Object(W.jsx)(I.a,{item:!0,xs:12,sx:{maxHeight:"60vh",padding:2,overflow:"auto"},children:Object(W.jsx)(D.a,{sx:{p:2,display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:Object(W.jsx)(re,{activePins:j,connected:i,sendHandler:c,setError:q})})}),Object(W.jsx)(I.a,{item:!0,xs:12,children:Object(W.jsx)(D.a,{sx:{p:2,display:"flex",flexDirection:"column"},children:Object(W.jsx)(T,{data:Z})})})]}),Object(W.jsx)(oe,{sx:{pt:4}})]})]})]})})},ue=[],Oe=Object(a.createContext)([]),be=function(){var e=Object(a.useState)(ue),t=Object(s.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)("ws://".concat(window.location.hostname,":8088")),r=Object(s.a)(c,2),o=r[0],l=r[1],u=Object(a.useRef)(),O=Object(a.useState)(!1),b=Object(s.a)(O,2),p=b[0],h=b[1],x=Object(a.useState)((function(){return function(){return function(e){return null}}})),m=Object(s.a)(x,2),f=m[0],g=m[1];return Object(a.useEffect)((function(){if(!u.current)try{var e=new j.NstrumentaClient({apiKey:"file?",wsUrl:o,projectId:"mapbox-geo"});u.current=e,e.addListener("open",(function(){console.log("a connection is made!"),h(!0),g((function(){return function(t){console.log("send message",t),t?e.send("gpio-command",{action:t.action,id:t.id,value:t.value,direction:t.direction}):console.log("nothing to send")}})),e.subscribe("gpio",(function(e){console.log("received message",e),i((function(t){return t.concat(e)}))}))})),e.addListener("close",(function(){console.log("lost ws connection"),h(!1)})),e.init()}catch(t){console.log(t),console.log(o),alert("problem with the websocket url!")}}),[o]),Object(a.useEffect)((function(){var e=window.location.search,t=new URLSearchParams(e).get("wsUrl");t&&l(t)}),[]),Object(W.jsx)(Oe.Provider,{value:n,children:Object(W.jsx)(d.a,{children:Object(W.jsx)(je,{sendHandler:f,wsUrl:o,setWsUrl:l,connected:p})})})};o.a.render(Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(l.a,{}),Object(W.jsx)(be,{})]}),document.getElementById("root"))}},[[424,1,2]]]);
//# sourceMappingURL=main.157b5ff3.chunk.js.map