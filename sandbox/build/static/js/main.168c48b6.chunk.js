(this["webpackJsonpgpio-sandbox"]=this["webpackJsonpgpio-sandbox"]||[]).push([[0],{422:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),c=n(48),r=n.n(c),o=n(484),l=n(13),s=n(5),d=n(38),j=n(4),u=n(241),O=n(493),p=n(494),b=n(497),h=n(501),x=n(502),m=n(504),g=n(498),y=n(503),f=n(505),v=n(495),w=n(499),I=n(500),D=n(491),k=n(486),S=n(485),C=n(490),U=n(506),G=n(507),P=n(473),R=n(475),z=n(1),N=function(e){var t=e.openViews,n=e.updateViews,i=function(e){return function(){return n(e,!t[e])}};return Object(z.jsxs)("div",{children:[Object(z.jsxs)(C.a,{button:!0,onClick:i("pins"),children:[Object(z.jsx)(U.a,{children:Object(z.jsx)(P.a,{color:t.pins?"primary":"disabled"})}),Object(z.jsx)(G.a,{primary:"Dashboard"})]}),Object(z.jsxs)(C.a,{button:!0,onClick:i("data"),children:[Object(z.jsx)(U.a,{children:Object(z.jsx)(R.a,{color:t.data?"primary":"disabled"})}),Object(z.jsx)(G.a,{primary:"View Data"})]})]})},E=n(508),H=n(512),W=n(511),T=n(509),V=n(510);function M(e){return Object(z.jsx)(g.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0,children:e.children})}function A(e){var t=e.data;return Object(z.jsxs)(a.a.Fragment,{children:[Object(z.jsx)(M,{children:"GPIO Pin Data"}),Object(z.jsxs)(E.a,{size:"small",children:[Object(z.jsx)(T.a,{children:Object(z.jsxs)(V.a,{children:[Object(z.jsx)(W.a,{width:100,children:"Pin Id"}),Object(z.jsx)(W.a,{width:100,children:"Time"}),Object(z.jsx)(W.a,{align:"right",children:"Value"})]})}),Object(z.jsx)(H.a,{children:t.map((function(e,t){var n=e.id,i=e.date,a=e.value;return Object(z.jsxs)(V.a,{children:[Object(z.jsx)(W.a,{children:n}),Object(z.jsx)(W.a,{children:i}),Object(z.jsx)(W.a,{align:"right",children:a?"1":"0"})]},t)}))})]})]})}var B,L,F=n(513),K=n(514),J=n(496),X=n(515),Y=n(481);!function(e){e.IN="in",e.OUT="out"}(B||(B={})),function(e){e.IO="io",e.POWER="power",e.GROUND="ground"}(L||(L={}));var q=n(49),Q=n(243),Z=n(479),$=n(480),_=n(235),ee=n(50),te=n(236);function ne(e){var t=e.data,n=(e.meta,Object(q.a)()),i=[];t&&(i=t.filter((function(e){return e.date>Date.now()-6e4})).map((function(e){return Object(d.a)(Object(d.a)({},e),{},{value:null===e.value?null:Number(e.value)})})));return Object(z.jsx)(b.a,{width:"100%",height:"100%",sx:{backgroundColor:"primary"},children:Object(z.jsx)(Z.a,{children:Object(z.jsxs)($.a,{data:i,margin:{top:0,right:0,bottom:0,left:0},children:[Object(z.jsx)(_.a,{hide:!0,dataKey:"date",type:"number",domain:[Date.now()-6e4,Date.now()],stroke:n.palette.text.secondary,style:n.typography.body2,children:Object(z.jsx)(ee.a,{position:"bottom",style:Object(d.a)({textAnchor:"middle",fill:n.palette.text.primary},n.typography.body1),children:"Time"})}),Object(z.jsx)(te.a,{hide:!0,type:"number",domain:[0,1],stroke:n.palette.text.secondary,style:n.typography.body2}),Object(z.jsx)(Q.a,{isAnimationActive:!1,type:"stepBefore",dataKey:"value",stroke:n.palette.primary.main,dot:!1,connectNulls:!1,strokeLinejoin:"miter"})]})})})}var ie=new Map([[1,{name:"pow3v3",direction:null,type:L.GROUND}],[2,{name:"pow5v",direction:null,type:L.POWER}],[3,{name:"gpio 2",direction:null,type:L.IO}],[4,{name:"pow5v",direction:null,type:L.POWER}],[5,{name:"gpio 3",direction:null,type:L.IO}],[6,{name:"gnd",direction:null,type:L.GROUND}],[7,{name:"gpio 4",direction:null,type:L.IO}],[8,{name:"gpio uart",direction:null,type:L.IO}],[9,{name:"gnd",direction:null,type:L.GROUND}],[10,{name:"gpio uart",direction:null,type:L.IO}],[11,{name:"gpio 17",direction:null,type:L.IO}],[12,{name:"gpio pcm",direction:null,type:L.IO}],[13,{name:"gpio 27",direction:null,type:L.IO}],[14,{name:"gnd",direction:null,type:L.GROUND}],[15,{name:"gpio 22",direction:null,type:L.IO}],[16,{name:"gpio",direction:null,type:L.IO}],[17,{name:"pow3v3",direction:null,type:L.POWER}],[18,{name:"gpio",direction:null,type:L.IO}],[19,{name:"gpio 10",direction:null,type:L.IO}],[20,{name:"gnd",direction:null,type:L.IO}],[21,{name:"gpio 9",direction:null,type:L.IO}],[22,{name:"gpio",direction:null,type:L.IO}],[23,{name:"gpio 11",direction:null,type:L.IO}],[24,{name:"gpio spi",direction:null,type:L.IO}],[25,{name:"gnd",direction:null,type:L.GROUND}],[26,{name:"gpio spi",direction:null,type:L.IO}],[27,{name:"gpio 0",direction:null,type:L.IO}],[28,{name:"gpio i2c",direction:null,type:L.IO}],[29,{name:"gpio 5",direction:null,type:L.IO}],[30,{name:"gnd",direction:null,type:L.GROUND}],[31,{name:"gpio 6",direction:null,type:L.IO}],[32,{name:"gpio",direction:null,type:L.IO}],[33,{name:"gpio 13",direction:null,type:L.IO}],[34,{name:"gnd",direction:null,type:L.GROUND}],[35,{name:"gpio 19",direction:null,type:L.IO}],[36,{name:"gpio",direction:null,type:L.IO}],[37,{name:"gpio 26",direction:null,type:L.IO}],[38,{name:"gpio pcm",direction:null,type:L.IO}],[39,{name:"gnd",direction:null,type:L.GROUND}],[40,{name:"gpio pcm",direction:null,type:L.IO}]]),ae=function(e){var t=e.onClick,n=e.type;return Object(z.jsx)(F.a,{onClick:t,children:Object(z.jsx)(Y.a,{color:n===L.IO?"primary":n===L.POWER?"secondary":"disabled"})})};function ce(e){var t=e.sendHandler,n=e.connected,a=e.setError,c=Object(i.useState)(ie),r=Object(l.a)(c,2),o=r[0],s=r[1],j=Object(i.useState)({minTime:0,maxTime:0,dataPoints:0}),u=Object(l.a)(j,2),O=u[0],p=u[1],b=Object(i.useContext)(Oe),h=Object(i.useMemo)((function(){return function(e){var n=e.id,i=e.value,a=ie.get(n);a&&"io"===a.type&&(ie.set(n,Object(d.a)(Object(d.a)({},a),{},{value:i})),s(new Map(ie)),t({id:n,value:i,action:"write"}))}}),[t]),x=Object(i.useMemo)((function(){return function(e){var n=e.id,i=e.newDirection,a=ie.get(n);if(a&&"io"===a.type){var c=i||a.direction;ie.set(n,Object(d.a)(Object(d.a)({},a),{},{direction:c})),s(new Map(ie)),t({action:"set",direction:c,id:n})}}}),[t]);return Object(i.useEffect)((function(){for(var e=0,t=function(){var t=Object(l.a)(i[n],2),a=t[0],c=t[1];c.data=b.filter((function(e){var t=e.id;return a===t})),c.data.length>e&&(e=c.data.length)},n=0,i=Array.from(o.entries());n<i.length;n++)t();var a=b.length>0?b[0].date:0,c=b.length>0?b[b.length-1].date:0;p({dataPoints:e,minTime:a,maxTime:c})}),[b]),Object(z.jsx)(i.Fragment,{children:Object(z.jsx)(K.a,{component:w.a,sx:{flexGrow:1},children:Object(z.jsx)(E.a,{"aria-label":"GPIO Pinout",children:Object(z.jsx)(H.a,{children:Array.from(o.entries()).map((function(e){var t=Object(l.a)(e,2),i=t[0],c=t[1];return Object(z.jsxs)(V.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(z.jsx)(W.a,{width:1,component:"td",sx:{backgroundColor:"default",cursor:"pointer"},children:Object(z.jsx)(g.a,{fontSize:10,children:c.name})}),Object(z.jsx)(W.a,{width:1,children:"io"===c.type&&Object(z.jsxs)(J.a,{size:"small",color:"primary",value:c.direction,exclusive:!0,sx:{fontSize:6,height:"10px",lineHeight:"10px"},onChange:function(e,t){n?x({id:i,newDirection:t}):a({wsHost:!0})},children:[Object(z.jsx)(X.a,{sx:{fontSize:8},value:"in",children:"In"}),Object(z.jsx)(X.a,{sx:{fontSize:8},value:"out",children:"Out"})]})}),Object(z.jsx)(W.a,{width:1,children:"io"===c.type&&Object(z.jsxs)(J.a,{size:"small",color:"out"===c.direction?"primary":"secondary",value:c.value,exclusive:!0,sx:{fontSize:6,height:"10px",lineHeight:"10px"},disabled:c.direction!==B.OUT,onChange:function(e,t){if(n){var a=null===t?c.value:t;void 0!==a&&h({id:i,value:a})}},children:[Object(z.jsx)(X.a,{sx:{fontSize:8},value:1,children:"1"}),Object(z.jsx)(X.a,{sx:{fontSize:8},value:0,children:"0"})]})}),Object(z.jsx)(W.a,{width:1,align:"right",children:Object(z.jsx)(ae,{type:c.type})}),Object(z.jsx)(W.a,{width:"auto",children:Object(z.jsx)(w.a,{sx:{p:2,display:"flex",flexDirection:"column",height:"80px"},children:Object(z.jsx)(ne,{meta:O,data:c.data||[]})})})]},i)}))})})})})}function re(e){return Object(z.jsxs)(g.a,Object(d.a)(Object(d.a)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Copyright \xa9 ",Object(z.jsx)(I.a,{color:"inherit",href:"https://nstrumenta.com/",children:"nstrumenta"})," ",(new Date).getFullYear(),"."]}))}var oe=Object(j.a)(h.a,{})((function(e){return{zIndex:e.theme.zIndex.drawer+1,marginLeft:72,width:"calc(100% - ".concat(72,"px)")}})),le=Object(j.a)(p.a,{})((function(e){var t=e.theme;return{"& .MuiDrawer-paper":Object(s.a)({position:"relative",whiteSpace:"nowrap",width:72,boxSizing:"border-box",overflowX:"hidden"},t.breakpoints.up("sm"),{width:t.spacing(9)})}})),se={dark:Object(u.a)({palette:{mode:"dark"}}),light:Object(u.a)({palette:{mode:"light"}})};function de(e){var t=e.wsUrl,n=e.setWsUrl,a=e.connected,c=e.sendHandler,r=Object(i.useState)(t),j=Object(l.a)(r,2),u=j[0],p=j[1],h=Object(i.useState)({pins:!0,data:!0}),I=Object(l.a)(h,2),C=I[0],U=I[1],G=Object(i.useState)("light"),P=Object(l.a)(G,2),R=P[0],E=P[1],H=Object(i.useState)({}),W=Object(l.a)(H,2),T=W[0],V=W[1];Object(i.useEffect)((function(){void 0!==T.wsHost&&V(Object(d.a)(Object(d.a)({},T),{},{wsHost:!a}))}),[a,T.wsHost]);var M=Object(i.useContext)(Oe);return Object(z.jsx)(O.a,{theme:se[R],children:Object(z.jsxs)(b.a,{sx:{display:"flex"},children:[Object(z.jsx)(o.a,{}),Object(z.jsx)(oe,{position:"absolute",children:Object(z.jsxs)(x.a,{children:[Object(z.jsx)(g.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,sx:{flexGrow:1},children:"Raspberry PI GPIO"}),Object(z.jsx)(g.a,{children:"Theme"}),Object(z.jsx)(D.a,{value:R,onChange:function(){return E((function(e){return"light"===e?"dark":"light"}))}})]})}),Object(z.jsxs)(le,{variant:"permanent",children:[Object(z.jsx)(x.a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",px:[1]},children:Object(z.jsx)(S.a,{color:a?"secondary":"disabled",sx:{backgroundColor:"action"}})}),Object(z.jsx)(y.a,{}),Object(z.jsx)(m.a,{children:Object(z.jsx)(N,{updateViews:function(e,t){console.log("updateViews",e,t),U(Object(d.a)(Object(d.a)({},C),{},Object(s.a)({},e,t)))},openViews:C})})]}),Object(z.jsxs)(b.a,{component:"main",sx:{flexGrow:1,height:"100vh",overflow:"auto"},children:[Object(z.jsx)(x.a,{}),Object(z.jsxs)(f.a,{maxWidth:!1,sx:{mt:4,mb:4},children:[Object(z.jsxs)(v.a,{container:!0,spacing:3,children:[Object(z.jsx)(v.a,{item:!0,xs:6,children:Object(z.jsx)(w.a,{sx:{padding:2},children:Object(z.jsx)(k.a,{variant:"standard",label:"websocket host",onChange:function(e){return p(e.target.value)},onBlur:function(){return n(u)},value:u,onKeyDown:function(e){"enter"===e.key.toLowerCase()&&n(u)},error:Boolean(T.wsHost),fullWidth:!0})})}),C.pins&&Object(z.jsx)(v.a,{item:!0,xs:12,height:"60vh",sx:{padding:2,overflow:"auto"},children:Object(z.jsx)(w.a,{sx:{p:2,display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:Object(z.jsx)(ce,{connected:a,sendHandler:c,setError:V})})}),Object(z.jsx)(v.a,{item:!0,xs:12,children:Object(z.jsx)(w.a,{sx:{p:2,display:"flex",flexDirection:"column"},children:Object(z.jsx)(A,{data:M})})})]}),Object(z.jsx)(re,{sx:{pt:4}})]})]})]})})}var je=n(240),ue=[],Oe=Object(i.createContext)([]);function pe(){var e=Object(i.useState)(ue),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(i.useState)("ws://".concat(window.location.hostname,":8088")),r=Object(l.a)(c,2),o=r[0],s=r[1],d=Object(i.useState)(!1),j=Object(l.a)(d,2),u=j[0],O=j[1],p=Object(i.useState)((function(){return function(){return function(e){return null}}})),h=Object(l.a)(p,2),x=h[0],m=h[1];return Object(i.useEffect)((function(){try{var e=new je.NstrumentaClient({apiKey:"file?",wsUrl:o,projectId:"mapbox-geo"});e.addListener("open",(function(){console.log("a connection is made!"),O(!0),m((function(){return function(t){console.log("send message",t),t?e.send("gpio-command",{action:t.action,id:t.id,value:t.value,direction:t.direction}):console.log("nothing to send")}})),e.subscribe("gpio",(function(e){console.log("received message",e),a((function(t){return t.concat(e)}))}))})),e.addListener("close",(function(){console.log("lost ws connection"),O(!1)})),e.init()}catch(t){console.log(t),console.log(o),alert("problem with the websocket url!")}}),[o]),Object(z.jsx)(Oe.Provider,{value:n,children:Object(z.jsx)(b.a,{children:Object(z.jsx)(de,{sendHandler:x,wsUrl:o,setWsUrl:s,connected:u})})})}r.a.render(Object(z.jsxs)(i.Fragment,{children:[Object(z.jsx)(o.a,{}),Object(z.jsx)(pe,{})]}),document.getElementById("root"))}},[[422,1,2]]]);
//# sourceMappingURL=main.168c48b6.chunk.js.map